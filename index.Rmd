---
title: "Interactive Charts with htmlwidgets"
author: "Martin John Hadley"
output: 
  html_document:
    toc: true
    toc_float: true
    number_sections: false
    code_folding: show
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(
	echo = TRUE,
	message = FALSE,
	warning = FALSE
)
library(htmltools)
```

The interactive web is built on JavaScript, from interactive bar charts like the one below (move your cursor over the barchart) to the interactive maps provided by Google, Bing and other services. There is a relatively simple way to build these interactive charts directly from R and to host these online via RPubs, GitHub Pages or to include such interactive data visualisations within a Shiny app. Note that the specific code for this interactive chart is available in the XXXXXXBARCHARTXXX section.

```{r, echo=FALSE, message=FALSE, warning=FALSE}
library(highcharter)
desktopItems <- read.csv(file = "https://ndownloader.figshare.com/files/5360960")
measure_column <- "Desktop.Items"
categories <- c("Operating.System","University.Department","University","Country")
selected_dimension <- categories[1]
aggregate_number_of_observations <- aggregate(data = desktopItems, eval(as.name(measure_column)) ~ eval(as.name(selected_dimension)), FUN = length)
colnames(aggregate_number_of_observations) <- c(selected_dimension,"Desktop.Items")
aggregate_number_of_observations <- aggregate_number_of_observations[order(aggregate_number_of_observations$Desktop.Items),]
format_label <- function(dimension){
  gsub(pattern = "[.]", replacement = " ", x = dimension)
}
highchart(height = 200) %>%
  hc_chart(type = "bar") %>%
  hc_xAxis(categories = aggregate_number_of_observations[,selected_dimension]) %>%
  hc_add_series(name = format_label(selected_dimension), data = rev(aggregate_number_of_observations[,measure_column])) %>%
  hc_yAxis(title = list(text = "Mean Number of Desktop Items")) %>%
  hc_title(text = paste0("Mean number of desktop items aggregated by ",format_label(selected_dimension)))
```

In order to generate these charts, R must generate the requisite HTML and JavaScript code for the visualisations. The RStudio company has made this process easy by developing a library called `htmlwidgets` which acts as a framework for building JavaScript bindings - which simply means: 

```
htmlwidgets provides standardised tools to build secondary R packages that bind to JavaScript libraries, the functions in these R packages can be used to generate the same output the original JavaScript library would
```

A popular visualisation library used in this tutorial is <a href=http://www.plot.ly>plot.ly</a>, the developers for plot.ly have created a library using `htmlwidgets` called `plotly` that allows interactive charts, maps and more to be generated directly from R code. Note that if you are following along with the code samples in this document you are advised to use RStudio which provides a built-in web viewer within which visualisations can be seen. The code below generates an interactive scatterplot using the `plotly.js` library:

```{r}
library(plotly)
library(gapminder)
plot_ly(data = gapminder,
        x = gapminder$year,
        y = gapminder$lifeExp,
        group = gapminder$continent,
        text = gapminder$country,
        mode = "markers")
```

# What's in this guide? 

There are over 15 CRAN-hosted libraries that utilise htmlwidgets for creating interactive content, the majority of these libraries are well documented at <a href="http://www.htmlwidgets.org">htmlwidgets.org</a>. The documentation at htmlwidgets.org is focused on individual libraries, it does not attempt to group them or compare the utility of the different libraries for specific types of charts.

This document is designed to address the following questions:

- Which library is capable of making chart X?
- Which charts can be made with library X?
- How do these charts compare against one another?

An interactive breakdown of the libraries is provided in the section below, however note that it is not the intention of this document to cover *all* available htmlwidget libraries - only those that have been used in the Live Data project

```{r child = 'htmlwidget-comparisons/index.Rmd'}
```


<!-- # ```{r child = 'charts/index.Rmd'} -->
<!-- # ``` -->


